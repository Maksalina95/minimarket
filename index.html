// Импортируем baseUrl из config.js
import { baseUrl } from './config.js';

document.addEventListener("DOMContentLoaded", () => {
  loadProducts(); // Загружаем начальный список товаров
  loadPage();     // Загружаем страницу по текущему хешу
});

window.addEventListener("hashchange", loadPage);

// Функция загрузки товаров
async function loadProducts() {
  const container = document.getElementById('products');
  if (!container) return;

  try {
    const res = await fetch(baseUrl);
    const data = await res.json();

    container.innerHTML = ''; // Очищаем перед загрузкой

    data.forEach(item => {
      // Пропускаем товары без изображения
      if (!item.изображение) return;

      const card = document.createElement('div');
      card.className = 'product-card';

      card.innerHTML = `
        <img src="${item.изображение}" alt="${item.название}" />
        <h3>${item.название || ''}</h3>
        <p>${item.описание || ''}</p>
        <strong>${item.цена ? item.цена + ' ₽' : ''}</strong>
      `;

      container.appendChild(card);
    });
  } catch (err) {
    console.error('Ошибка при загрузке товаров:', err);
    container.innerHTML = '<p>Не удалось загрузить товары. Попробуйте позже.</p>';
  }
}

// Функция загрузки нужной страницы по hash (если у тебя одностраничный сайт)
function loadPage() {
  const page = location.hash.replace('#', '') || 'home';
  const sections = document.querySelectorAll('section[data-page]');

  sections.forEach(section => {
    section.style.display = (section.dataset.page === page) ? 'block' : 'none';
  });
}
